<!DOCTYPE html>
<html>
<head>
    <title>Galactic Exoplanet Distribution</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    //-------------------------------------------------------------------------------
    <script>
        let scene, camera, renderer, controls;
        let galaxyPlane, exoplanets = [];

        // Configuration
        const config = {
            galaxySize: 136000,  // Approximate galaxy diameter in light years
            pointSize: 100,      // Sphere size for exoplanets
            rotationSpeed: 0.005
        };

        init();
        animate();

        //-------------------------------------------------------------------------------
        async function init() {
            // Scene setup
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 1000000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Camera position
            camera.position.set(0, 50000, 50000);

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Add galaxy plane
            createGalaxyPlane();
            
            // Load and plot exoplanets
            await loadExoplanets();

            // Add Galactic North marker
            addGalacticNorthMarker();
        }

        //-------------------------------------------------------------------------------
        function createGalaxyPlane() {
            // Create galaxy plane with PNG texture
            const textureLoader = new THREE.TextureLoader();
            textureLoader.load('MW_transparent_small.png', (texture) => {
                const geometry = new THREE.PlaneGeometry(config.galaxySize, config.galaxySize);
                const material = new THREE.MeshBasicMaterial({
                    map: texture,
                    transparent: true,
                    opacity: 1.0,
                    side: THREE.DoubleSide,
                    color: new THREE.Color(1.0, 1.0, 1.0)
                });
                
                galaxyPlane = new THREE.Mesh(geometry, material);
                galaxyPlane.rotation.x = -Math.PI / 2;
                scene.add(galaxyPlane);
            });
        }

        //-------------------------------------------------------------------------------
        async function loadExoplanets() {
            const response = await fetch('Exoplanets_coordinates.json');
            const data = await response.json();

            const material = new THREE.MeshBasicMaterial({ color: 0x30db55 });

            data.forEach((exoplanet) => {
                const sphereGeometry = new THREE.SphereGeometry(config.pointSize, 8, 8);
                const sphere = new THREE.Mesh(sphereGeometry, material);
                
                sphere.position.set(
                    exoplanet[0],    // X
                    exoplanet[2],    // Z (Three.js Y)
                    -exoplanet[1]    // Y (Three.js Z)
                );

                scene.add(sphere);
                exoplanets.push(sphere);
            });
        }

        //-------------------------------------------------------------------------------
        function addGalacticNorthMarker() {
            // Create canvas and draw the "N"
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 512;
            
            // Draw the letter "N"
            context.fillStyle = 'white';
            context.font = 'bold 100px Arial';
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            context.fillText('N', canvas.width / 2, canvas.height / 2);
            
            // Create a texture from the canvas
            const texture = new THREE.CanvasTexture(canvas);
            const spriteMaterial = new THREE.SpriteMaterial({ map: texture, transparent: true });
            const sprite = new THREE.Sprite(spriteMaterial);

            sprite.scale.set(6000, 6000, 1); // Adjust size of the "N"
            sprite.position.set(0, 30000, 0); // Position at Galactic North

            scene.add(sprite);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
